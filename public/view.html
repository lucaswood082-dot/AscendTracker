<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Workouts</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Sticky Top Navigation */
    .top-nav {
      position: sticky;
      top: 0;
      z-index: 100;
      background: #111827;
      border-bottom: 1px solid #1f2937;
      padding: 1rem;
      text-align: center;
      font-weight: 600;
      color: #38bdf8;
      font-size: 1.2rem;
    }
    .back-btn {
      display: inline-block;
      margin: 0.5rem auto 1rem auto;
      padding: 0.5rem 1rem;
      border-radius: 10px;
      border: none;
      background: #38bdf8;
      color: #020617;
      font-weight: 600;
      cursor: pointer;
      font-size: 0.9rem;
      text-align: center;
    }
    .back-btn:hover { opacity: 0.85; }

    .page { display: flex; flex-direction: column; padding-top: 1rem; max-height: calc(100vh - 60px); }
    .container { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
    .card { flex: 1; display: flex; flex-direction: column; overflow: hidden; margin-bottom: 1rem; padding: 1rem; border-radius: 12px; background: #020617; border: 1px solid #1f2937; }
    #workoutsList { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; }
    .exercise-name { font-weight: 600; margin-top: 0.5rem; }
    .set-item { margin-left: 10px; font-size: 0.9rem; display: flex; gap: 12px; }
  </style>
</head>
<body>

<div class="top-nav">Ascend</div>
<div style="text-align:center;">
  <button class="back-btn" onclick="window.location.href='workout.html'">‚Üê Back to Create Workout</button>
</div>

<div class="page">
  <div class="container">
    <div id="workoutsList"></div>
    <button type="button" class="secondary" onclick="location.href='workout.html'">
      Create New Workout
    </button>
  </div>
</div>

<script>
console.log("view.js loaded");

const workoutsList = document.getElementById("workoutsList");

// Load current user workouts
const users = JSON.parse(localStorage.getItem("users")) || [];
const currentUser = users[0]; // assuming single user for now

workoutsList.innerHTML = "";

if (!currentUser || !currentUser.workouts || currentUser.workouts.length === 0) {
  workoutsList.innerHTML = `<p style="text-align:center; color:#9ca3af;">No workouts saved yet.</p>`;
} else {
  currentUser.workouts.forEach((w, i) => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <h3>${w.name} (${w.date})</h3>
      <ul>
        ${w.exercises.map(ex => `
          <li>
            <strong>${ex.name}</strong>
            <ul>
              ${ex.sets.map(s => {
                if (ex.unilateral) {
                  return `<li>Left: ${s.leftReps} | Right: ${s.rightReps} | Weight: ${s.weight}kg</li>`;
                } else {
                  return `<li>Reps: ${s.reps} | Weight: ${s.weight}kg</li>`;
                }
              }).join("")}
            </ul>
          </li>
        `).join("")}
      </ul>
      <button class="danger">Delete</button>
    `;

    // Delete button
    card.querySelector(".danger").addEventListener("click", () => {
      currentUser.workouts.splice(i, 1);
      users[0] = currentUser;
      localStorage.setItem("users", JSON.stringify(users));
      card.remove();
    });

    workoutsList.appendChild(card);
  });
}
</script>

</body>
</html>
